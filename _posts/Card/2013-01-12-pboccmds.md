---
layout:     post
title:      PBOC常用指令
category: Card
description: Select、GPO、GAC etc.
---

先来解释两个名词：

  **GET PROCESSING OPTIONS（GPO） 获取处理选项**

终端通知卡片交易开始，并且从卡片获取信息，知道卡片支持哪些功能，便于后续交易使用这些功能及信息(卡片返回AIP AFL)。卡片只是返回数据给终端。

相当于终端知道本次交易如何进行。

AIP:说明此应用中卡片支持指定功能的能力（SDA、标准DDA、CDA、终端风险管理、持卡人验证和发卡行认证）

AFL:说明终端作交易处理要读出的卡片数据存放的文件位置和记录范围

&nbsp;

  **GENERATE APPLICATION CRYPTOGRAM (GAC) 生成应用密文**

终端发送给卡片，请求卡片给出一个密文来授权（authorization），卡片收到命令后经过分析和计算返回一个应用密文（9F26）和密文信息数据（9F27），来表明自己对交易处理的决定，卡片需要计算。

想当于终端与卡片共同决定一次交易的结果，但终端具有否决权。

在智能卡领域APDU（<span style="font-weight: normal;">application protocol data unit，应用协议数据单元</span>）是终端（或者说读卡器）与卡片之间的通信单元，其结构是由7816-4规范来定义的：

<table width="1713" border="2" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="91">
      字段名
    </td>
    
    <td valign="top" width="111">
      长度(Byte)
    </td>
    
    <td valign="top" width="507">
      解释
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="102">
      CLA
    </td>
    
    <td valign="top" width="111">
      0x01
    </td>
    
    <td valign="top" width="507">
      指令类型 &#8211; 指示命令的类型，例如行业间命令或者专有命令
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="108">
      INS
    </td>
    
    <td valign="top" width="111">
      0x01
    </td>
    
    <td valign="top" width="507">
      指令代码 &#8211; 表示特定的命令，如“写数据”
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="112">
      P1
    </td>
    
    <td valign="top" width="111">
      0x01
    </td>
    
    <td valign="top" width="507">
      该命令APDU的指令参数1
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="113">
      P2
    </td>
    
    <td valign="top" width="111">
      0x01
    </td>
    
    <td valign="top" width="507">
      该命令APDU的指令参数2
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="114">
      Lc
    </td>
    
    <td valign="top" width="111">
      0x00/0x01/0x02
    </td>
    
    <td valign="top" width="1507">
      存放Data数据的长度
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="114">
      Data
    </td>
    
    <td valign="top" width="111">
      Var
    </td>
    
    <td valign="top" width="507">
      指令的数据域
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="113">
      Le
    </td>
    
    <td valign="top" width="111">
      0x00&#8211;0x03
    </td>
    
    <td valign="top" width="507">
      指明预期响应数据的最大字节数
    </td>
  </tr>
</table>

注：Lc与Data是同时存在的或者同时不存在；Lc与Le不应同时存在。

为什么长度字段会出现0x02这是因为在超过7F时，前面需要追加81，无法理解的话请忽略吧。

我假设你已经理解了，下面开始介绍常用交易指令：

  * **选择（SELECT）命令报文**

<table width="400" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="33">
      CLA
    </td>
    
    <td valign="top" width="32">
      INS
    </td>
    
    <td valign="top" width="22">
      P1
    </td>
    
    <td valign="top" width="10">
      P2
    </td>
    
    <td valign="top" width="72">
      Lc
    </td>
    
    <td valign="top" width="227">
      Data
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="33">
      0x00
    </td>
    
    <td valign="top" width="32">
      0xA4
    </td>
    
    <td valign="top" width="22">
      0x04
    </td>
    
    <td valign="top" width="10">
      0x00/0x02
    </td>
    
    <td valign="top" width="72">
      0x05-0x10
    </td>
    
    <td valign="top" width="227">
      AID/PSE/PPSE
    </td>
  </tr>
</table>

注：若P2=0x00表示选第一个应用；P2=0x02表示选下一个应用。

PSE: 1PAY.SYS.DDF01 &#8212;>315041592E5359532E4444463031（ASCII码转换成16进制）

PPSE:1PAY.SYS.DDF01 &#8212;>325041592E5359532E4444463031（ASCII码转换成16进制）

AID: A0000003330101等.

指令实例：

00A4 0400 0E 315041592E5359532E4444463031

00A4 0400 0E 325041592E5359532E4444463031

00A4 0400 07 A0000003330101

00A4 0402 08 A000000333010102

&nbsp;

  * **获取处理选项（GPO）命令报文**

<table width="398" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="33">
      CLA
    </td>
    
    <td valign="top" width="32">
      INS
    </td>
    
    <td valign="top" width="22">
      P1
    </td>
    
    <td valign="top" width="10">
      P2
    </td>
    
    <td valign="top" width="72">
      Lc
    </td>
    
    <td valign="top" width="227">
      Data
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="33">
      0x80
    </td>
    
    <td valign="top" width="32">
      0xA8
    </td>
    
    <td valign="top" width="22">
      0x00
    </td>
    
    <td valign="top" width="10">
      0x00
    </td>
    
    <td valign="top" width="72">
      Var
    </td>
    
    <td valign="top" width="227">
      PDOL相关数据
    </td>
  </tr>
</table>

例如：80A8 0000 19 83 17 <span style="color: #0000ff;">112233</span> <span style="color: #9b00d3;">1122334455667788990011223344556677889900</span>

PDOL通过标签“83”标记，此处的PDOL值为9F3806 <span style="color: #0000ff;">9F3303</span> <span style="color: #9b00d3;">9F4E14 ,</span><span style="color: #000000;">9F38的值是通过个人化写入的，选择AID时返回给终端，终端再根据PDOL来组织数据。</span>

PDOL相关数据是根据 处理选项数据对象列表（PDOL 9F38）来编码的。

&nbsp;

  * **读记录（READ RECORD）命令报文**

<table width="484" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="92">
      CLA
    </td>
    
    <td valign="top" width="76">
      INS
    </td>
    
    <td valign="top" width="90">
      P1
    </td>
    
    <td valign="top" width="144">
      P2
    </td>
    
    <td valign="top" width="80">
      Le
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="120">
      0x00
    </td>
    
    <td valign="top" width="97">
      0xB2
    </td>
    
    <td valign="top" width="108">
      记录号
    </td>
    
    <td valign="top" width="158">
      引用控制参数
    </td>
    
    <td valign="top" width="95">
      0x00或其它
    </td>
  </tr>
</table>

通过SFI(短文件标识符)和记录号可以确定一条记录

SFI:占5个bit位 范围0x01-0x1F

引用控制参数的高5bit位为SFI,低3bit位补100，例如SFI为02的引用控制参数为：

<table width="400" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="50">
      bit8
    </td>
    
    <td valign="top" width="50">
      bit7
    </td>
    
    <td valign="top" width="50">
      bit6
    </td>
    
    <td valign="top" width="50">
      bit5
    </td>
    
    <td valign="top" width="50">
      bit4
    </td>
    
    <td valign="top" width="50">
      bit3
    </td>
    
    <td valign="top" width="50">
      bit2
    </td>
    
    <td valign="top" width="50">
      bit1
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="50">
    </td>
    
    <td valign="top" width="50">
    </td>
    
    <td valign="top" width="50">
    </td>
    
    <td valign="top" width="50">
      1
    </td>
    
    <td valign="top" width="50">
    </td>
    
    <td valign="top" width="50">
      <span style="color: #ff0000;">1</span>
    </td>
    
    <td valign="top" width="50">
      <span style="color: #ff0000;"></span>
    </td>
    
    <td valign="top" width="50">
      <span style="color: #ff0000;"></span>
    </td>
  </tr>
</table>

bit8-bit5为SFI，bit3-bit1为补位，故引用控制参数为14

读SFI为0x<span style="color: #9b00d3;">02</span>,记录号为<span style="color: #0000ff;">01</span>的记录指令为：00B2 <span style="color: #0000ff;">01</span><span style="color: #9b00d3;">14</span> 00

&nbsp;

  * **生成应用密文（GENERATE AC）命令报文**

<table width="398" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="33">
      CLA
    </td>
    
    <td valign="top" width="32">
      INS
    </td>
    
    <td valign="top" width="99">
      P1
    </td>
    
    <td valign="top" width="46">
      P2
    </td>
    
    <td valign="top" width="47">
      Lc
    </td>
    
    <td valign="top" width="139">
      Data
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="33">
      0x80
    </td>
    
    <td valign="top" width="32">
      0xAE
    </td>
    
    <td valign="top" width="99">
      引用控制参数
    </td>
    
    <td valign="top" width="46">
      0x00
    </td>
    
    <td valign="top" width="47">
      Var
    </td>
    
    <td valign="top" width="139">
      CDOL相关数据
    </td>
  </tr>
</table>

引用控制参数：

<table width="400" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="12">
      bit8
    </td>
    
    <td valign="top" width="17">
      bit7
    </td>
    
    <td valign="top" width="16">
      bit6
    </td>
    
    <td valign="top" width="12">
      bit5
    </td>
    
    <td valign="top" width="14">
      bit4
    </td>
    
    <td valign="top" width="10">
      bit3
    </td>
    
    <td valign="top" width="10">
      bit2
    </td>
    
    <td valign="top" width="26">
      bit1
    </td>
    
    <td valign="top" width="279">
      说明
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="17">
    </td>
    
    <td valign="top" width="16">
    </td>
    
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="14">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="279">
      AAC
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="12">
      1
    </td>
    
    <td valign="top" width="17">
    </td>
    
    <td valign="top" width="16">
    </td>
    
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="14">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="279">
      ARQC
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="17">
      1
    </td>
    
    <td valign="top" width="16">
    </td>
    
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="14">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="279">
      TC
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="17">
    </td>
    
    <td valign="top" width="16">
    </td>
    
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="14">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="279">
      不请求CDA
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="17">
    </td>
    
    <td valign="top" width="16">
    </td>
    
    <td valign="top" width="12">
      1
    </td>
    
    <td valign="top" width="14">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="279">
      请求CDA
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="12">
      1
    </td>
    
    <td valign="top" width="17">
      1
    </td>
    
    <td valign="top" width="16">
    </td>
    
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="14">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="279">
      RFU
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="17">
    </td>
    
    <td valign="top" width="16">
      x
    </td>
    
    <td valign="top" width="12">
    </td>
    
    <td valign="top" width="14">
      x
    </td>
    
    <td valign="top" width="10">
      x
    </td>
    
    <td valign="top" width="10">
      x
    </td>
    
    <td valign="top" width="26">
      x
    </td>
    
    <td valign="top" width="279">
      RFU
    </td>
  </tr>
</table>

AAC代表拒绝交易， ARQC代表联机请求， TC代表接受交易， CDA是脱机数据验证方式的一种（SDA/DDA/CDA）

例如：80AE <span style="color: #d16349;">80</span>00 20 0000000010000000000000000156000000000001560001250924320012345678

GAC请求了ARQC(未请求CDA).

CDOL相关数据是根据 卡片风险管理数据对象列表1、表2（CDOL1 TAG8C;CDOL2 TAG8D）来编码的，也是通过个人化写入的，通过读记录指令返回，其格式类似于PDOL.

&nbsp;

  * **内部认证（INTERNAL AUTHENTICATE）命令报文**

<table width="253" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="33">
      CLA
    </td>
    
    <td valign="top" width="32">
      INS
    </td>
    
    <td valign="top" width="25">
      P1
    </td>
    
    <td valign="top" width="22">
      P2
    </td>
    
    <td valign="top" width="27">
      Lc
    </td>
    
    <td valign="top" width="112">
      Data
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="33">
      0x00
    </td>
    
    <td valign="top" width="32">
      0x88
    </td>
    
    <td valign="top" width="25">
      0x00
    </td>
    
    <td valign="top" width="22">
      0x00
    </td>
    
    <td valign="top" width="27">
      Var
    </td>
    
    <td valign="top" width="112">
      认证相关数据
    </td>
  </tr>
</table>

认证相关数据根据动态数据认证数据对象列表（DDOL TAG9F49）规则来编码的,且9F49至少包含终端随机数9F37.

例如： 0088 0000 04 <span style="color: #ff0000;">11223344</span>，此处DDOL为9F49 03 <span style="color: #ff0000;">9F3704</span>

&nbsp;

  * **外部认证（EXTERNAL AUTHENTICATE）命令报文**

<table width="253" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="33">
      CLA
    </td>
    
    <td valign="top" width="32">
      INS
    </td>
    
    <td valign="top" width="25">
      P1
    </td>
    
    <td valign="top" width="22">
      P2
    </td>
    
    <td valign="top" width="27">
      Lc
    </td>
    
    <td valign="top" width="112">
      Data
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="33">
      0x00
    </td>
    
    <td valign="top" width="32">
      0x82
    </td>
    
    <td valign="top" width="25">
      0x00
    </td>
    
    <td valign="top" width="22">
      0x00
    </td>
    
    <td valign="top" width="27">
      0x0A
    </td>
    
    <td valign="top" width="112">
      发卡行认证数据
    </td>
  </tr>
</table>

发卡行认证数据TAG91:授权响应密文ARPC（8字节）+授权响应码（2字节）,其中ARPC是根据GAC指令返回的应用密文以及ARC来计算出的。

&nbsp;

  * **取数据（GET DATA）命令报文**

<table width="394" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="20">
      CLA
    </td>
    
    <td valign="top" width="34">
      INS
    </td>
    
    <td valign="top" width="104">
      P1
    </td>
    
    <td valign="top" width="102">
      P2
    </td>
    
    <td valign="top" width="132">
      Le
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="20">
      0x80
    </td>
    
    <td valign="top" width="34">
      0xCA
    </td>
    
    <td valign="top" width="104">
      TAG的第一字节
    </td>
    
    <td valign="top" width="102">
      TAG的第一字节
    </td>
    
    <td valign="top" width="132">
      0x00或其它
    </td>
  </tr>
</table>

例如：80CA 9F36 00 (TAG9F36为应用交易计数器，即交易的次数)

&nbsp;

  * **验证（VERIFY）命令报文**

<table width="270" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="10">
      CLA
    </td>
    
    <td valign="top" width="10">
      INS
    </td>
    
    <td valign="top" width="10">
      P1
    </td>
    
    <td valign="top" width="92">
      P2
    </td>
    
    <td valign="top" width="49">
      Lc
    </td>
    
    <td valign="top" width="97">
      Data
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="10">
      0x00
    </td>
    
    <td valign="top" width="10">
      0x20
    </td>
    
    <td valign="top" width="10">
      0x00
    </td>
    
    <td valign="top" width="92">
      参考数据定义
    </td>
    
    <td valign="top" width="49">
      Var
    </td>
    
    <td valign="top" width="97">
      交易PIN数据
    </td>
  </tr>
</table>

P2参考数据：

<table width="400" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="17">
      bit8
    </td>
    
    <td valign="top" width="10">
      bit7
    </td>
    
    <td valign="top" width="10">
      bit6
    </td>
    
    <td valign="top" width="10">
      bit5
    </td>
    
    <td valign="top" width="10">
      bit4
    </td>
    
    <td valign="top" width="21">
      bit3
    </td>
    
    <td valign="top" width="10">
      bit2
    </td>
    
    <td valign="top" width="26">
      bit1
    </td>
    
    <td valign="top" width="288">
      说明
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="17">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="21">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="288">
      ISO/IEC7816-4定义
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="17">
      1
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="21">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="288">
      明文PIN，格式见下表
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="17">
      1
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
      1
    </td>
    
    <td valign="top" width="21">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="288">
      EMV定义，密文PIN
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="17">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="21">
    </td>
    
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="26">
    </td>
    
    <td valign="top" width="288">
      其他
    </td>
  </tr>
</table>

PBOC规范只规定了明文PIN格式，密文PIN没有要求，但卡片也可以支持

明文PIN数据块按如下格式组织：

<table width="400" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="25">
      C
    </td>
    
    <td valign="top" width="25">
      N
    </td>
    
    <td valign="top" width="25">
      P
    </td>
    
    <td valign="top" width="25">
      P
    </td>
    
    <td valign="top" width="25">
      P
    </td>
    
    <td valign="top" width="25">
      P
    </td>
    
    <td valign="top" width="25">
      P/F
    </td>
    
    <td valign="top" width="25">
      P/F
    </td>
    
    <td valign="top" width="25">
      P/F
    </td>
    
    <td valign="top" width="25">
      P/F
    </td>
    
    <td valign="top" width="25">
      P/F
    </td>
    
    <td valign="top" width="25">
      P/F
    </td>
    
    <td valign="top" width="25">
      P/F
    </td>
    
    <td valign="top" width="25">
      P/F
    </td>
    
    <td valign="top" width="25">
      F
    </td>
    
    <td valign="top" width="25">
      F
    </td>
  </tr>
</table>

其中

<table width="400" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="10">
    </td>
    
    <td valign="top" width="80">
      名称
    </td>
    
    <td valign="top" width="313">
      值
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="10">
      C
    </td>
    
    <td valign="top" width="80">
      控制域
    </td>
    
    <td valign="top" width="313">
      值为0010的四位二进制数（hex. 2）
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="10">
      N
    </td>
    
    <td valign="top" width="80">
      PIN长度
    </td>
    
    <td valign="top" width="313">
      值在0100到1100之间的4位二进制数（hex. 4-C）
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="10">
      P
    </td>
    
    <td valign="top" width="80">
      PIN数字
    </td>
    
    <td valign="top" width="313">
      值在0000到1001之间的4位二进制数（hex. 0-9）
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="10">
      P/F
    </td>
    
    <td valign="top" width="80">
      PIN/填充位F
    </td>
    
    <td valign="top" width="313">
      由N决定，hex. 0-9或者F
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="10">
      F
    </td>
    
    <td valign="top" width="80">
      填充位F
    </td>
    
    <td valign="top" width="313">
      值为1111的四位二进制数（hex. F）
    </td>
  </tr>
</table>

例如：0020 0080 08 2 6 123489FFFFFFFF（明文PIN,PIN为123489）

&nbsp;

  * **发卡行脚本指令**

常见的发卡行脚本指令有：应用解锁、应用锁定、卡片锁定、PIN修改/解锁、设置数据、修改记录。

这里以设置数据为例：

<table width="322" border="1" cellspacing="0" cellpadding="2">
  <tr>
    <td valign="top" width="10">
      CLA
    </td>
    
    <td valign="top" width="10">
      INS
    </td>
    
    <td valign="top" width="97">
      P1
    </td>
    
    <td valign="top" width="103">
      P2
    </td>
    
    <td valign="top" width="11">
      Lc
    </td>
    
    <td valign="top" width="89">
      Data
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="10">
      0x04
    </td>
    
    <td valign="top" width="10">
      0xDA
    </td>
    
    <td valign="top" width="97">
      TAG的第一字节
    </td>
    
    <td valign="top" width="103">
      TAG的第二字节
    </td>
    
    <td valign="top" width="11">
      Var
    </td>
    
    <td valign="top" width="89">
      新值+MAC
    </td>
  </tr>
</table>

例如：04DA 9F79 0A 000000005000 EA12B56F（并不是所有的TAG都是可以修改的）

详细指令介绍请参考：中国金融集成电路（IC）卡规范第5部分：借记贷记应用卡片规范

&nbsp;
